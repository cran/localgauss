<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code>
<a name="lgobfun_dv_dv"></a><code class="comment">!  Tapenade 3.2 (r3024) - 06/17/2009 13:03</code>
<code class="comment">!  </code>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!  Differentiation of lgobfun_dv in forward (tangent) mode: (multi-directional mode)</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!   variations  of output variables: lld</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!   with respect to input variables: pp</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!  Tapenade 3.2 (r3024) - 06/17/2009 13:03</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!  </code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!  Differentiation of lgobfun in forward (tangent) mode: (multi-directional mode)</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!   variations  of output variables: ll</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!   with respect to input variables: pp</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">! This is the objective function</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">LGOBFUN_DV_DV</code>(<code class="vardecl">n</code>, <code class="vardecl">x</code>, <code class="vardecl">y</code>, <code class="vardecl">wts</code>, <code class="vardecl">x0</code>, <code class="vardecl">y0</code>, <code class="vardecl">pp</code>, <code class="vardecl">ppd0</code>, <code class="vardecl">ppd</code>, <code class="vardecl">hx</code>, <code class="vardecl">hy</code>, <code class="vardecl">ll</code><code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="label">&  </code>, <code class="vardecl">lld</code>, <code class="vardecl">lldd</code>, <code class="vardecl">cv</code>, <code class="vardecl">fixrho</code>, <code class="vardecl">nbdirs</code>, <code class="vardecl">nbdirs0</code>)</a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">USE </code><code class="funcname">DIFFSIZES</code></a>
<a name="lgobfun_dv_dvi0"></a><a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="comment">!  Hint: nbdirsmax should be the maximum number of differentiation directions</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="lgobfun_dv_dvi1"></a><a href="obfun_dv.html#lgobfun_dvi0" target="origFile"><code class="comment">! number of data points</code></a>
  <a href="obfun_dv.html#lgobfun_dvi0" target="origFile"><code class="typename">INTEGER, INTENT(IN) </code>:: <code class="vardecl">n</code></a>
<a name="lgobfun_dv_dvi2"></a><a href="obfun_dv.html#lgobfun_dvi1" target="origFile"><code class="comment">! x-data points</code></a>
  <a href="obfun_dv.html#lgobfun_dvi1" target="origFile"><code class="typename">REAL*8, DIMENSION(n), INTENT(IN) </code>:: <code class="vardecl">x</code></a>
<a name="lgobfun_dv_dvi3"></a><a href="obfun_dv.html#lgobfun_dvi2" target="origFile"><code class="comment">! y-data points</code></a>
  <a href="obfun_dv.html#lgobfun_dvi2" target="origFile"><code class="typename">REAL*8, DIMENSION(n), INTENT(IN) </code>:: <code class="vardecl">y</code></a>
<a name="lgobfun_dv_dvi4"></a><a href="obfun_dv.html#lgobfun_dvi3" target="origFile"><code class="comment">! kernel weights of each data point</code></a>
  <a href="obfun_dv.html#lgobfun_dvi3" target="origFile"><code class="typename">REAL*8, DIMENSION(n), INTENT(IN) </code>:: <code class="vardecl">wts</code></a>
<a name="lgobfun_dv_dvi5"></a><a href="obfun_dv.html#lgobfun_dvi4" target="origFile"><code class="comment">! x-coordinate where local parameters are computed</code></a>
  <a href="obfun_dv.html#lgobfun_dvi4" target="origFile"><code class="typename">REAL*8, INTENT(IN) </code>:: <code class="vardecl">x0</code></a>
<a name="lgobfun_dv_dvi6"></a><a href="obfun_dv.html#lgobfun_dvi5" target="origFile"><code class="comment">! y-coordinate where local parameters are computed</code></a>
  <a href="obfun_dv.html#lgobfun_dvi5" target="origFile"><code class="typename">REAL*8, INTENT(IN) </code>:: <code class="vardecl">y0</code></a>
<a href="obfun_dv.html#lgobfun_dvi6" target="origFile"><code class="comment">! transformed parameters used by optimizer</code></a>
<a name="lgobfun_dv_dvi7"></a>  <a href="obfun_dv.html#lgobfun_dvi6" target="origFile"><code class="typename">REAL*8, DIMENSION(5), INTENT(IN) </code>:: <code class="vardecl">pp</code></a>
<a name="lgobfun_dv_dvi8"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5), INTENT(IN) </code>:: <code class="vardecl">ppd0</code></a>
  <a href="obfun_dv.html#lgobfun_dvi7" target="origFile"><code class="typename">REAL*8, DIMENSION(5, 5), INTENT(IN) </code>:: <code class="vardecl">ppd</code></a>
<a name="lgobfun_dv_dvi9"></a><a href="obfun_dv.html#lgobfun_dvi8" target="origFile"><code class="comment">! x-dir bandwidth</code></a>
  <a href="obfun_dv.html#lgobfun_dvi8" target="origFile"><code class="typename">REAL*8, INTENT(IN) </code>:: <code class="vardecl">hx</code></a>
<a name="lgobfun_dv_dvi10"></a><a href="obfun_dv.html#lgobfun_dvi9" target="origFile"><code class="comment">! y-dir bandwidth</code></a>
  <a href="obfun_dv.html#lgobfun_dvi9" target="origFile"><code class="typename">REAL*8, INTENT(IN) </code>:: <code class="vardecl">hy</code></a>
<a name="lgobfun_dv_dvi11"></a><a href="obfun_dv.html#lgobfun_dvi10" target="origFile"><code class="comment">! should the input parameters be transformed?</code></a>
  <a href="obfun_dv.html#lgobfun_dvi10" target="origFile"><code class="typename">LOGICAL, INTENT(IN) </code>:: <code class="vardecl">cv</code></a>
<a name="lgobfun_dv_dvi12"></a><a href="obfun_dv.html#lgobfun_dvi11" target="origFile"><code class="comment">! fixed rho?</code></a>
  <a href="obfun_dv.html#lgobfun_dvi11" target="origFile"><code class="typename">REAL*8, INTENT(IN) </code>:: <code class="vardecl">fixrho</code></a>
<a name="lgobfun_dv_dvi13"></a><a href="obfun_dv.html#lgobfun_dvi12" target="origFile"><code class="comment">! objective function out</code></a>
  <a href="obfun_dv.html#lgobfun_dvi12" target="origFile"><code class="typename">REAL*8, INTENT(OUT) </code>:: <code class="vardecl">ll</code></a>
<a name="lgobfun_dv_dvi14"></a>  <a href="obfun_dv.html#lgobfun_dvi13" target="origFile"><code class="typename">REAL*8, INTENT(OUT) </code>:: <code class="vardecl">lld</code>(<code class="constant">5</code>)</a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, INTENT(OUT) </code>:: <code class="vardecl">lldd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>)</a>
<a name="lgobfun_dv_dvi15"></a>  <a href="obfun_dv.html#lgobfun_dvi14" target="origFile"><code class="typename">REAL*8, DIMENSION(n) </code>:: <code class="vardecl">lgauss</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, n) </code>:: <code class="vardecl">lgaussd0</code></a>
<a name="lgobfun_dv_dvi16"></a>  <a href="obfun_dv.html#lgobfun_dvi15" target="origFile"><code class="typename">REAL*8, DIMENSION(5, n) </code>:: <code class="vardecl">lgaussd</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, n) </code>:: <code class="vardecl">lgaussdd</code></a>
<a name="lgobfun_dv_dvi17"></a>  <a href="obfun_dv.html#lgobfun_dvi16" target="origFile"><code class="typename">REAL*8, DIMENSION(5) </code>:: <code class="vardecl">pars2</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5) </code>:: <code class="vardecl">pars2d0</code></a>
<a name="lgobfun_dv_dvi18"></a>  <a href="obfun_dv.html#lgobfun_dvi17" target="origFile"><code class="typename">REAL*8, DIMENSION(5, 5) </code>:: <code class="vardecl">pars2d</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, 5) </code>:: <code class="vardecl">pars2dd</code></a>
<a name="lgobfun_dv_dvi19"></a>  <a href="obfun_dv.html#lgobfun_dvi18" target="origFile"><code class="typename">REAL*8, DIMENSION(1) </code>:: <code class="vardecl">xtmp</code>, <code class="vardecl">ytmp</code>, <code class="vardecl">restmp</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 1) </code>:: <code class="vardecl">xtmpd0</code>, <code class="vardecl">ytmpd0</code>, <code class="vardecl">restmpd0</code></a>
<a name="lgobfun_dv_dvi20"></a>  <a href="obfun_dv.html#lgobfun_dvi19" target="origFile"><code class="typename">REAL*8, DIMENSION(5, 1) </code>:: <code class="vardecl">xtmpd</code>, <code class="vardecl">ytmpd</code>, <code class="vardecl">restmpd</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, 1) </code>:: <code class="vardecl">restmpdd</code></a>
<a name="lgobfun_dv_dvi21"></a>  <a href="obfun_dv.html#lgobfun_dvi20" target="origFile"><code class="typename">REAL*8, DIMENSION(5) </code>:: <code class="vardecl">pars</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5) </code>:: <code class="vardecl">parsd0</code></a>
<a name="lgobfun_dv_dvi22"></a>  <a href="obfun_dv.html#lgobfun_dvi21" target="origFile"><code class="typename">REAL*8, DIMENSION(5, 5) </code>:: <code class="vardecl">parsd</code></a>
<a name="lgobfun_dv_dvi23"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, 5) </code>:: <code class="vardecl">parsdd</code></a>
  <a href="obfun_dv.html#lgobfun_dvi22" target="origFile"><code class="typename">REAL*8, DIMENSION(n) </code>:: <code class="vardecl">arg1</code></a>
<a name="lgobfun_dv_dvi24"></a>  <a href="obfun_dv.html#lgobfun_dvi23" target="origFile"><code class="typename">REAL*8, DIMENSION(5, n) </code>:: <code class="vardecl">arg1d</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, n) </code>:: <code class="vardecl">arg1dd</code></a>
<a name="lgobfun_dv_dvi25"></a>  <a href="obfun_dv.html#lgobfun_dvi24" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg10</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg10d0</code>(<code class="vardecl">nbdirsmax</code>)</a>
<a name="lgobfun_dv_dvi26"></a>  <a href="obfun_dv.html#lgobfun_dvi25" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg10d</code>(<code class="constant">5</code>)</a>
<a name="lgobfun_dv_dvi27"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg10dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>)</a>
<a name="lgobfun_dv_dvi28"></a>  <a href="obfun_dv.html#lgobfun_dvi26" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nd</code></a>
<a name="lgobfun_dv_dvi29"></a>  <a href="obfun_dv.html#lgobfun_dvi27" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbdirs</code></a>
<a name="lgobfun_dv_dvi30"></a>  <a href="obfun_dv.html#lgobfun_dvi28" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">EXP</code></a>
<a name="lgobfun_dv_dvi31"></a>  <a href="obfun_dv.html#lgobfun_dvi29" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
<a name="lgobfun_dv_dvi32"></a>  <a href="obfun_dv.html#lgobfun_dvi30" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
<a name="lgobfun_dv_dvi33"></a>  <a href="obfun_dv.html#lgobfun_dvi31" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">abs2</code></a>
<a name="lgobfun_dv_dvi34"></a>  <a href="obfun_dv.html#lgobfun_dvi32" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">abs1</code></a>
  <a href="obfun_dv.html#lgobfun_dvi33" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="obfun_dv.html#lgobfun_dvi34" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1d</code>(<code class="vardecl">nbdirsmax</code>)</a>
<a name="lgobfun_dv_dvi35"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nd0</code></a>
<a name="lgobfun_dv_dvi36"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbdirs0</code></a>
  <a href="obfun_dv.html#lgobfun_dvi35" target="origFile">ll = <code class="constant">0.0_8</code></a>
<a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="comment">! if cv=TRUE; Transform parameters</code></a>
  <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">IF</code> (cv) <code class="keyword">THEN</code></a>
    <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
<a name="lgobfun_dv_dvi37"></a>      <a href="obfun_dv.html#lgobfun_dvi36" target="origFile">parsdd(nd0, :, :) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi38"></a>    <a href="obfun_dv.html#lgobfun_dvi37" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
<a name="lgobfun_dv_dvi39"></a>      <a href="obfun_dv.html#lgobfun_dvi37" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi38" target="origFile">parsdd(nd0, nd, <code class="constant">1</code>:<code class="constant">2</code>) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi39" target="origFile">parsdd(nd0, nd, <code class="constant">3</code>:<code class="constant">4</code>) = ppd(nd, <code class="constant">3</code>:<code class="constant">4</code>)*ppd0(nd0, <code class="constant">3</code>:<code class="constant">4</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">3</code>:<code class="constant">4</code>))</a>
      <a href="obfun_dv.html#lgobfun_dvi37" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi38" target="origFile">parsd(nd, <code class="constant">1</code>:<code class="constant">2</code>) = ppd(nd, <code class="constant">1</code>:<code class="constant">2</code>)</a>
      <a href="obfun_dv.html#lgobfun_dvi39" target="origFile">parsd(nd, <code class="constant">3</code>:<code class="constant">4</code>) = ppd(nd, <code class="constant">3</code>:<code class="constant">4</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">3</code>:<code class="constant">4</code>))</a>
<a name="lgobfun_dv_dvi40"></a>    <a href="obfun_dv.html#lgobfun_dvi37" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi41"></a>    <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#lgobfun_dvi40" target="origFile">parsd0(nd0, <code class="constant">1</code>:<code class="constant">2</code>) = ppd0(nd0, <code class="constant">1</code>:<code class="constant">2</code>)</a>
      <a href="obfun_dv.html#lgobfun_dvi41" target="origFile">parsd0(nd0, <code class="constant">3</code>:<code class="constant">4</code>) = ppd0(nd0, <code class="constant">3</code>:<code class="constant">4</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">3</code>:<code class="constant">4</code>))</a>
    <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi42"></a>    <a href="obfun_dv.html#lgobfun_dvi40" target="origFile">pars(<code class="constant">1</code>:<code class="constant">2</code>) = pp(<code class="constant">1</code>:<code class="constant">2</code>)</a>
<a name="lgobfun_dv_dvi43"></a>    <a href="obfun_dv.html#lgobfun_dvi41" target="origFile">pars(<code class="constant">3</code>:<code class="constant">4</code>) = <code class="funcname">EXP</code>(pp(<code class="constant">3</code>:<code class="constant">4</code>))</a>
    <a href="obfun_dv.html#lgobfun_dvi42" target="origFile"><code class="keyword">IF</code> (fixrho .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="lgobfun_dv_dvi44"></a>      <a href="obfun_dv.html#lgobfun_dvi43" target="origFile">abs1 = fixrho</a>
    <a href="obfun_dv.html#lgobfun_dvi42" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi45"></a>      <a href="obfun_dv.html#lgobfun_dvi44" target="origFile">abs1 = -fixrho</a>
    <a href="obfun_dv.html#lgobfun_dvi42" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">IF</code> (abs1 .LT. <code class="constant">1.0_8</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
<a name="lgobfun_dv_dvi46"></a>        <a href="obfun_dv.html#lgobfun_dvi45" target="origFile">lldd(nd0, :) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi47"></a>      <a href="obfun_dv.html#lgobfun_dvi46" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
<a name="lgobfun_dv_dvi48"></a>        <a href="obfun_dv.html#lgobfun_dvi46" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
          <a href="obfun_dv.html#lgobfun_dvi47" target="origFile">parsdd(nd0, nd, <code class="constant">5</code>) = <code class="constant">0.0_8</code></a>
          <a href="obfun_dv.html#lgobfun_dvi48" target="origFile">lldd(nd0, nd) = -(<code class="constant">0.5_8</code>*<code class="constant">2</code>*ppd(nd, <code class="constant">5</code>)*ppd0(nd0, <code class="constant">5</code>))</a>
        <a href="obfun_dv.html#lgobfun_dvi46" target="origFile"><code class="keyword">END DO</code></a>
        <a href="obfun_dv.html#lgobfun_dvi47" target="origFile">parsd(nd, <code class="constant">5</code>) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi48" target="origFile">lld(nd) = -(<code class="constant">0.5_8</code>*<code class="constant">2</code>*pp(<code class="constant">5</code>)*ppd(nd, <code class="constant">5</code>))</a>
<a name="lgobfun_dv_dvi49"></a>      <a href="obfun_dv.html#lgobfun_dvi46" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi49" target="origFile">parsd0(nd0, <code class="constant">5</code>) = <code class="constant">0.0_8</code></a>
<a name="lgobfun_dv_dvi50"></a>      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi49" target="origFile">pars(<code class="constant">5</code>) = fixrho</a>
<a href="obfun_dv.html#lgobfun_dvi50" target="origFile"><code class="comment">! add this to make optimizer work</code></a>
<a href="obfun_dv.html#lgobfun_dvi50" target="origFile"><code class="comment">! if rho is fixed</code></a>
<a name="lgobfun_dv_dvi51"></a>      <a href="obfun_dv.html#lgobfun_dvi50" target="origFile">ll = -(<code class="constant">0.5_8</code>*pp(<code class="constant">5</code>)**<code class="constant">2</code>)</a>
    <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi52"></a>      <a href="obfun_dv.html#lgobfun_dvi51" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
        <a href="obfun_dv.html#lgobfun_dvi51" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
          <a href="obfun_dv.html#lgobfun_dvi52" target="origFile">parsdd(nd0, nd, <code class="constant">5</code>) = ((<code class="constant">2.0_8</code>*ppd(nd, <code class="constant">5</code>)*(ppd0(nd0, <code class="constant">5</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">5</code><code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi52" target="origFile"><code class="label">&            </code>))*(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))**<code class="constant">2</code>*ppd0(nd0, <code class="constant">5</code>))-<code class="constant">2.0_8</code>*ppd(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi52" target="origFile"><code class="label">&            </code>nd, <code class="constant">5</code>)*<code class="constant">2</code>*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))**<code class="constant">2</code>*ppd0(nd0, <code class="constant">5</code>))*(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))**<code class="constant">2</code>-(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi52" target="origFile"><code class="label">&            </code><code class="constant">2.0_8</code>*ppd(nd, <code class="constant">5</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))*(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))-<code class="constant">2.0_8</code>*<code class="funcname">EXP</code>(pp(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi52" target="origFile"><code class="label">&            </code><code class="constant">5</code>))**<code class="constant">2</code>*ppd(nd, <code class="constant">5</code>))*<code class="constant">2</code>*(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))*ppd0(nd0, <code class="constant">5</code>)*<code class="funcname">EXP</code>(pp(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi52" target="origFile"><code class="label">&            </code><code class="constant">5</code>)))/((<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))**<code class="constant">2</code>)**<code class="constant">2</code></a>
        <a href="obfun_dv.html#lgobfun_dvi51" target="origFile"><code class="keyword">END DO</code></a>
        <a href="obfun_dv.html#lgobfun_dvi52" target="origFile">parsd(nd, <code class="constant">5</code>) = (<code class="constant">2.0_8</code>*ppd(nd, <code class="constant">5</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))*(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))-<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi52" target="origFile"><code class="label">&          </code><code class="constant">2.0_8</code>*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))**<code class="constant">2</code>*ppd(nd, <code class="constant">5</code>))/(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))**<code class="constant">2</code></a>
<a name="lgobfun_dv_dvi53"></a>      <a href="obfun_dv.html#lgobfun_dvi51" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi53" target="origFile">parsd0(nd0, <code class="constant">5</code>) = (<code class="constant">2.0_8</code>*ppd0(nd0, <code class="constant">5</code>)*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))*(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi53" target="origFile"><code class="label">&          </code>))-<code class="constant">2.0_8</code>*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))**<code class="constant">2</code>*ppd0(nd0, <code class="constant">5</code>))/(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))**<code class="constant">2</code></a>
<a name="lgobfun_dv_dvi54"></a>      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi53" target="origFile">pars(<code class="constant">5</code>) = -<code class="constant">1.0_8 </code>+ <code class="constant">2.0_8</code>*<code class="funcname">EXP</code>(pp(<code class="constant">5</code>))/(<code class="constant">1.0_8</code>+<code class="funcname">EXP</code>(pp(<code class="constant">5</code>)))</a>
<a name="lgobfun_dv_dvi55"></a>      <a href="obfun_dv.html#lgobfun_dvi54" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
        <a href="obfun_dv.html#lgobfun_dvi54" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
          <a href="obfun_dv.html#lgobfun_dvi55" target="origFile">lldd(nd0, nd) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi54" target="origFile"><code class="keyword">END DO</code></a>
        <a href="obfun_dv.html#lgobfun_dvi55" target="origFile">lld(nd) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi54" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi45" target="origFile">lldd(nd0, :) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi56"></a>    <a href="obfun_dv.html#lgobfun_dvi45" target="origFile"><code class="keyword">END IF</code></a>
  <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi57"></a>    <a href="obfun_dv.html#lgobfun_dvi56" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
      <a href="obfun_dv.html#lgobfun_dvi56" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi57" target="origFile">parsdd(nd0, nd, :) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi56" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi57" target="origFile">parsd(nd, :) = ppd(nd, :)</a>
<a name="lgobfun_dv_dvi58"></a>    <a href="obfun_dv.html#lgobfun_dvi56" target="origFile"><code class="keyword">END DO</code></a>
    <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#lgobfun_dvi58" target="origFile">parsd0(nd0, :) = ppd0(nd0, :)</a>
    <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi59"></a><a href="obfun_dv.html#lgobfun_dvi58" target="origFile"><code class="comment">! otherwise, pass parameters as they are</code></a>
<a name="lgobfun_dv_dvi60"></a>    <a href="obfun_dv.html#lgobfun_dvi58" target="origFile">pars = pp</a>
    <a href="obfun_dv.html#lgobfun_dvi59" target="origFile"><code class="keyword">IF</code> (fixrho .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="lgobfun_dv_dvi61"></a>      <a href="obfun_dv.html#lgobfun_dvi60" target="origFile">abs2 = fixrho</a>
    <a href="obfun_dv.html#lgobfun_dvi59" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi62"></a>      <a href="obfun_dv.html#lgobfun_dvi61" target="origFile">abs2 = -fixrho</a>
<a name="lgobfun_dv_dvi63"></a>    <a href="obfun_dv.html#lgobfun_dvi59" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">IF</code> (abs2 .LT. <code class="constant">1.0_8</code>) <code class="keyword">THEN</code></a>
<a name="lgobfun_dv_dvi64"></a>      <a href="obfun_dv.html#lgobfun_dvi63" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
        <a href="obfun_dv.html#lgobfun_dvi63" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
          <a href="obfun_dv.html#lgobfun_dvi64" target="origFile">parsdd(nd0, nd, <code class="constant">5</code>) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi63" target="origFile"><code class="keyword">END DO</code></a>
        <a href="obfun_dv.html#lgobfun_dvi64" target="origFile">parsd(nd, <code class="constant">5</code>) = <code class="constant">0.0_8</code></a>
<a name="lgobfun_dv_dvi65"></a>      <a href="obfun_dv.html#lgobfun_dvi63" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi65" target="origFile">parsd0(nd0, <code class="constant">5</code>) = <code class="constant">0.0_8</code></a>
<a name="lgobfun_dv_dvi66"></a>      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi65" target="origFile">pars(<code class="constant">5</code>) = fixrho</a>
<a name="lgobfun_dv_dvi67"></a>      <a href="obfun_dv.html#lgobfun_dvi66" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
        <a href="obfun_dv.html#lgobfun_dvi66" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
          <a href="obfun_dv.html#lgobfun_dvi67" target="origFile">lldd(nd0, nd) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi66" target="origFile"><code class="keyword">END DO</code></a>
        <a href="obfun_dv.html#lgobfun_dvi67" target="origFile">lld(nd) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi66" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi62" target="origFile">lldd(nd0, :) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi62" target="origFile">parsdd(nd0, :, :) = <code class="constant">0.0_8</code></a>
<a name="lgobfun_dv_dvi68"></a>      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">END DO</code></a>
    <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi69"></a>      <a href="obfun_dv.html#lgobfun_dvi68" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
        <a href="obfun_dv.html#lgobfun_dvi68" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
          <a href="obfun_dv.html#lgobfun_dvi69" target="origFile">lldd(nd0, nd) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi68" target="origFile"><code class="keyword">END DO</code></a>
        <a href="obfun_dv.html#lgobfun_dvi69" target="origFile">lld(nd) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi68" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi62" target="origFile">lldd(nd0, :) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi62" target="origFile">parsdd(nd0, :, :) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi70"></a>    <a href="obfun_dv.html#lgobfun_dvi62" target="origFile"><code class="keyword">END IF</code></a>
  <a href="obfun_dv.html#lgobfun_dvi36" target="origFile"><code class="keyword">END IF</code></a>
<a href="obfun_dv.html#lgobfun_dvi70" target="origFile"><code class="comment">! compute logdensites for the weighted log-likelihood</code></a>
  <a href="obfun_dv.html#lgobfun_dvi70" target="origFile"><code class="keyword">CALL </code><code class="funcname">LOGGAUSSPDF_DV_DV</code>(n, x, y, pars, parsd0, parsd, parsdd, lgauss, <code class="label">&</code></a>
<a name="lgobfun_dv_dvi71"></a><a href="obfun_dv.html#lgobfun_dvi70" target="origFile"><code class="label">&                   </code>lgaussd0, lgaussd, lgaussdd, nbdirs, nbdirs0)</a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#lgobfun_dvi71" target="origFile">arg10d0(nd0) = <code class="constant">2</code>*pars(<code class="constant">3</code>)*parsd0(nd0, <code class="constant">3</code>)</a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#lgobfun_dvi71" target="origFile">arg10 = pars(<code class="constant">3</code>)**<code class="constant">2 </code>+ hx**<code class="constant">2</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#lgobfun_dv" target="origFile">arg1dd(nd0, :, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#lgobfun_dv" target="origFile">pars2dd(nd0, :, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
<a name="lgobfun_dv_dvi72"></a>    <a href="obfun_dv.html#lgobfun_dv" target="origFile">arg10dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi73"></a>  <a href="obfun_dv.html#lgobfun_dvi72" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
<a name="lgobfun_dv_dvi74"></a>    <a href="obfun_dv.html#lgobfun_dvi72" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
<a name="lgobfun_dv_dvi75"></a>      <a href="obfun_dv.html#lgobfun_dvi73" target="origFile">arg1dd(nd0, nd, :) = wts*lgaussdd(nd0, nd, :)</a>
<a name="lgobfun_dv_dvi76"></a>      <a href="obfun_dv.html#lgobfun_dvi74" target="origFile">lldd(nd0, nd) = lldd(nd0, nd) + <code class="funcname">SUM</code>(arg1dd(nd0, nd, :))/(<code class="constant">1.0_8</code>*n)</a>
      <a href="obfun_dv.html#lgobfun_dvi75" target="origFile">pars2dd(nd0, nd, <code class="constant">1</code>:<code class="constant">2</code>) = parsdd(nd0, nd, <code class="constant">1</code>:<code class="constant">2</code>)</a>
      <a href="obfun_dv.html#lgobfun_dvi76" target="origFile">arg10dd(nd0, nd) = <code class="constant">2</code>*(parsd0(nd0, <code class="constant">3</code>)*parsd(nd, <code class="constant">3</code>)+pars(<code class="constant">3</code>)*parsdd(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi76" target="origFile"><code class="label">&        </code>nd0, nd, <code class="constant">3</code>))</a>
    <a href="obfun_dv.html#lgobfun_dvi72" target="origFile"><code class="keyword">END DO</code></a>
    <a href="obfun_dv.html#lgobfun_dvi73" target="origFile">arg1d(nd, :) = wts*lgaussd(nd, :)</a>
    <a href="obfun_dv.html#lgobfun_dvi74" target="origFile">lld(nd) = lld(nd) + <code class="funcname">SUM</code>(arg1d(nd, :))/(<code class="constant">1.0_8</code>*n)</a>
<a name="p0"></a><a name="lgobfun_dv_dvi77"></a>    <a href="obfun_dv.html#lgobfun_dvi75" target="origFile">pars2d(nd, <code class="constant">1</code>:<code class="constant">2</code>) = parsd(nd, <code class="constant">1</code>:<code class="constant">2</code>)</a>
    <a href="obfun_dv.html#lgobfun_dvi76" target="origFile">arg10d(nd) = <code class="constant">2</code>*pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">3</code>)</a>
<a name="lgobfun_dv_dvi78"></a>    <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p0" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="obfun_dv.html#lgobfun_dvi77" target="origFile">arg10 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi78" target="origFile">pars2dd(nd0, nd, <code class="constant">3</code>) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi78" target="origFile">pars2d(nd, <code class="constant">3</code>) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi79"></a>      <a href="obfun_dv.html#lgobfun_dvi79" target="origFile">result1 = <code class="funcname">SQRT</code>(arg10)</a>
      <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi79" target="origFile"><code class="keyword">IF</code> (arg10 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="obfun_dv.html#lgobfun_dvi79" target="origFile">result1d(nd0) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi79" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi80"></a>          <a href="obfun_dv.html#lgobfun_dvi79" target="origFile">result1d(nd0) = arg10d0(nd0)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg10))</a>
        <a href="obfun_dv.html#lgobfun_dvi79" target="origFile"><code class="keyword">END IF</code></a>
        <a href="obfun_dv.html#lgobfun_dvi80" target="origFile">pars2dd(nd0, nd, <code class="constant">3</code>) = (arg10dd(nd0, nd)*<code class="constant">2.0</code>*result1-arg10d(nd)*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi80" target="origFile"><code class="label">&          </code><code class="constant">2.0</code>*result1d(nd0))/(<code class="constant">2.0</code>*result1)**<code class="constant">2</code></a>
      <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi80" target="origFile">pars2d(nd, <code class="constant">3</code>) = arg10d(nd)/(<code class="constant">2.0</code>*result1)</a>
<a name="lgobfun_dv_dvi81"></a>    <a href="obfun_dv.html#lgobfun_dvi77" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#lgobfun_dvi72" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#lgobfun_dvi81" target="origFile">arg10dd(nd0, nd) = <code class="constant">2</code>*(parsd0(nd0, <code class="constant">4</code>)*parsd(nd, <code class="constant">4</code>)+pars(<code class="constant">4</code>)*parsdd(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi81" target="origFile"><code class="label">&        </code>nd0, nd, <code class="constant">4</code>))</a>
<a name="lgobfun_dv_dvi82"></a>    <a href="obfun_dv.html#lgobfun_dvi72" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi83"></a>    <a href="obfun_dv.html#lgobfun_dvi81" target="origFile">arg10d(nd) = <code class="constant">2</code>*pars(<code class="constant">4</code>)*parsd(nd, <code class="constant">4</code>)</a>
    <a href="obfun_dv.html#lgobfun_dvi82" target="origFile">xtmpd(nd, <code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
<a name="lgobfun_dv_dvi84"></a>    <a href="obfun_dv.html#lgobfun_dvi83" target="origFile">ytmpd(nd, <code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#lgobfun_dvi72" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi85"></a><a href="obfun_dv.html#lgobfun_dvi84" target="origFile"><code class="comment">! weighted log-likelihood</code></a>
  <a href="obfun_dv.html#lgobfun_dvi84" target="origFile">arg1(:) = wts*lgauss</a>
<a name="lgobfun_dv_dvi86"></a>  <a href="obfun_dv.html#lgobfun_dvi85" target="origFile">ll = ll + <code class="funcname">SUM</code>(arg1(:))/(<code class="constant">1.0_8</code>*n)</a>
<a name="lgobfun_dv_dvi87"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#lgobfun_dvi86" target="origFile">pars2d0(nd0, <code class="constant">1</code>:<code class="constant">2</code>) = parsd0(nd0, <code class="constant">1</code>:<code class="constant">2</code>)</a>
    <a href="obfun_dv.html#lgobfun_dvi87" target="origFile"><code class="keyword">IF</code> (arg10 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#lgobfun_dvi87" target="origFile">pars2d0(nd0, <code class="constant">3</code>) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#lgobfun_dvi87" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi88"></a>      <a href="obfun_dv.html#lgobfun_dvi87" target="origFile">pars2d0(nd0, <code class="constant">3</code>) = arg10d0(nd0)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg10))</a>
    <a href="obfun_dv.html#lgobfun_dvi87" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#lgobfun_dvi88" target="origFile">arg10d0(nd0) = <code class="constant">2</code>*pars(<code class="constant">4</code>)*parsd0(nd0, <code class="constant">4</code>)</a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
<a href="obfun_dv.html#lgobfun_dvi86" target="origFile"><code class="comment">! work out parameters for the penalty term</code></a>
  <a href="obfun_dv.html#lgobfun_dvi86" target="origFile">pars2(<code class="constant">1</code>:<code class="constant">2</code>) = pars(<code class="constant">1</code>:<code class="constant">2</code>)</a>
  <a href="obfun_dv.html#lgobfun_dvi87" target="origFile">pars2(<code class="constant">3</code>) = <code class="funcname">SQRT</code>(arg10)</a>
<a name="lgobfun_dv_dvi89"></a>  <a href="obfun_dv.html#lgobfun_dvi88" target="origFile">arg10 = pars(<code class="constant">4</code>)**<code class="constant">2 </code>+ hy**<code class="constant">2</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#lgobfun_dvi89" target="origFile"><code class="keyword">IF</code> (arg10 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#lgobfun_dvi89" target="origFile">pars2d0(nd0, <code class="constant">4</code>) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#lgobfun_dvi89" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="obfun_dv.html#lgobfun_dvi89" target="origFile">pars2d0(nd0, <code class="constant">4</code>) = arg10d0(nd0)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg10))</a>
    <a href="obfun_dv.html#lgobfun_dvi89" target="origFile"><code class="keyword">END IF</code></a>
<a name="lgobfun_dv_dvi90"></a>  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
<a name="p1"></a><a name="lgobfun_dv_dvi91"></a>  <a href="obfun_dv.html#lgobfun_dvi89" target="origFile">pars2(<code class="constant">4</code>) = <code class="funcname">SQRT</code>(arg10)</a>
  <a href="obfun_dv.html#lgobfun_dvi90" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
<a name="lgobfun_dv_dvi92"></a>    <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p1" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="obfun_dv.html#lgobfun_dvi91" target="origFile">arg10 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi92" target="origFile">pars2dd(nd0, nd, <code class="constant">4</code>) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi92" target="origFile">pars2d(nd, <code class="constant">4</code>) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi93"></a>      <a href="obfun_dv.html#lgobfun_dvi93" target="origFile">result1 = <code class="funcname">SQRT</code>(arg10)</a>
      <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#lgobfun_dvi93" target="origFile"><code class="keyword">IF</code> (arg10 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="obfun_dv.html#lgobfun_dvi93" target="origFile">result1d(nd0) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#lgobfun_dvi93" target="origFile"><code class="keyword">ELSE</code></a>
<a name="lgobfun_dv_dvi94"></a>          <a href="obfun_dv.html#lgobfun_dvi93" target="origFile">result1d(nd0) = arg10d0(nd0)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg10))</a>
        <a href="obfun_dv.html#lgobfun_dvi93" target="origFile"><code class="keyword">END IF</code></a>
        <a href="obfun_dv.html#lgobfun_dvi94" target="origFile">pars2dd(nd0, nd, <code class="constant">4</code>) = (arg10dd(nd0, nd)*<code class="constant">2.0</code>*result1-arg10d(nd)*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi94" target="origFile"><code class="label">&          </code><code class="constant">2.0</code>*result1d(nd0))/(<code class="constant">2.0</code>*result1)**<code class="constant">2</code></a>
      <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#lgobfun_dvi94" target="origFile">pars2d(nd, <code class="constant">4</code>) = arg10d(nd)/(<code class="constant">2.0</code>*result1)</a>
<a name="lgobfun_dv_dvi95"></a>    <a href="obfun_dv.html#lgobfun_dvi91" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#lgobfun_dvi90" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#lgobfun_dvi95" target="origFile">pars2dd(nd0, nd, <code class="constant">5</code>) = ((((parsdd(nd0, nd, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+parsd(nd, <code class="constant">5</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>parsd0(nd0, <code class="constant">3</code>)+parsd0(nd0, <code class="constant">5</code>)*parsd(nd, <code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsdd(nd0, <code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>nd, <code class="constant">3</code>))*pars(<code class="constant">4</code>)+(parsd(nd, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd(nd, <code class="constant">3</code>))*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>parsd0(nd0, <code class="constant">4</code>)+(parsd0(nd0, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd0(nd0, <code class="constant">3</code>))*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>parsd(nd, <code class="constant">4</code>)+pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*parsdd(nd0, nd, <code class="constant">4</code>))*pars2(<code class="constant">3</code>)*pars2(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code><code class="constant">4</code>)+((parsd(nd, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd(nd, <code class="constant">3</code>))*pars(<code class="constant">4</code>)+pars(<code class="constant">5</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>))*(pars2d0(nd0, <code class="constant">3</code>)*pars2(<code class="constant">4</code>)+pars2(<code class="constant">3</code>)*pars2d0<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>(nd0, <code class="constant">4</code>))-((parsd0(nd0, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd0(nd0, <code class="constant">3</code>))*pars(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code><code class="constant">4</code>)+pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*parsd0(nd0, <code class="constant">4</code>))*(pars2d(nd, <code class="constant">3</code>)*pars2(<code class="constant">4</code>)+pars2<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>(<code class="constant">3</code>)*pars2d(nd, <code class="constant">4</code>))-pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)*(pars2dd(nd0, nd, <code class="constant">3</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>pars2(<code class="constant">4</code>)+pars2d(nd, <code class="constant">3</code>)*pars2d0(nd0, <code class="constant">4</code>)+pars2d0(nd0, <code class="constant">3</code>)*pars2d(nd<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>, <code class="constant">4</code>)+pars2(<code class="constant">3</code>)*pars2dd(nd0, nd, <code class="constant">4</code>)))*pars2(<code class="constant">3</code>)**<code class="constant">2</code>*pars2(<code class="constant">4</code>)**<code class="constant">2</code>-(((<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>parsd(nd, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd(nd, <code class="constant">3</code>))*pars(<code class="constant">4</code>)+pars(<code class="constant">5</code>)*pars(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code><code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>))*pars2(<code class="constant">3</code>)*pars2(<code class="constant">4</code>)-pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)*(<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>pars2d(nd, <code class="constant">3</code>)*pars2(<code class="constant">4</code>)+pars2(<code class="constant">3</code>)*pars2d(nd, <code class="constant">4</code>)))*<code class="constant">2</code>*pars2(<code class="constant">3</code>)*pars2<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>(<code class="constant">4</code>)*(pars2d0(nd0, <code class="constant">3</code>)*pars2(<code class="constant">4</code>)+pars2(<code class="constant">3</code>)*pars2d0(nd0, <code class="constant">4</code>)))/((pars2<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&        </code>(<code class="constant">3</code>)*pars2(<code class="constant">4</code>))**<code class="constant">2</code>)**<code class="constant">2</code></a>
    <a href="obfun_dv.html#lgobfun_dvi90" target="origFile"><code class="keyword">END DO</code></a>
    <a href="obfun_dv.html#lgobfun_dvi95" target="origFile">pars2d(nd, <code class="constant">5</code>) = (((parsd(nd, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd(nd, <code class="constant">3</code>))*pars(<code class="constant">4</code><code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&      </code>)+pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>))*pars2(<code class="constant">3</code>)*pars2(<code class="constant">4</code>)-pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&      </code>pars(<code class="constant">4</code>)*(pars2d(nd, <code class="constant">3</code>)*pars2(<code class="constant">4</code>)+pars2(<code class="constant">3</code>)*pars2d(nd, <code class="constant">4</code>)))/(pars2(<code class="constant">3</code>)<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi95" target="origFile"><code class="label">&      </code>*pars2(<code class="constant">4</code>))**<code class="constant">2</code></a>
<a name="lgobfun_dv_dvi96"></a>  <a href="obfun_dv.html#lgobfun_dvi90" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#lgobfun_dvi96" target="origFile">pars2d0(nd0, <code class="constant">5</code>) = (((parsd0(nd0, <code class="constant">5</code>)*pars(<code class="constant">3</code>)+pars(<code class="constant">5</code>)*parsd0(nd0, <code class="constant">3</code>))*<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi96" target="origFile"><code class="label">&      </code>pars(<code class="constant">4</code>)+pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*parsd0(nd0, <code class="constant">4</code>))*pars2(<code class="constant">3</code>)*pars2(<code class="constant">4</code>)-pars(<code class="constant">5</code>)*<code class="label">&</code></a>
<a name="lgobfun_dv_dvi97"></a><a href="obfun_dv.html#lgobfun_dvi96" target="origFile"><code class="label">&      </code>pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)*(pars2d0(nd0, <code class="constant">3</code>)*pars2(<code class="constant">4</code>)+pars2(<code class="constant">3</code>)*pars2d0(nd0, <code class="constant">4</code>)<code class="label">&</code></a>
<a name="lgobfun_dv_dvi98"></a><a href="obfun_dv.html#lgobfun_dvi96" target="origFile"><code class="label">&      </code>))/(pars2(<code class="constant">3</code>)*pars2(<code class="constant">4</code>))**<code class="constant">2</code></a>
    <a href="obfun_dv.html#lgobfun_dvi97" target="origFile">xtmpd0(nd0, <code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#lgobfun_dvi98" target="origFile">ytmpd0(nd0, <code class="constant">1</code>) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#lgobfun_dvi96" target="origFile">pars2(<code class="constant">5</code>) = pars(<code class="constant">5</code>)*pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)/(pars2(<code class="constant">3</code>)*pars2(<code class="constant">4</code>))</a>
<a name="lgobfun_dv_dvi99"></a>  <a href="obfun_dv.html#lgobfun_dvi97" target="origFile">xtmp(<code class="constant">1</code>) = x0</a>
  <a href="obfun_dv.html#lgobfun_dvi98" target="origFile">ytmp(<code class="constant">1</code>) = y0</a>
  <a href="obfun_dv.html#lgobfun_dvi99" target="origFile"><code class="keyword">CALL </code><code class="funcname">LOGGAUSSPDF_DV_DV</code>(<code class="constant">1</code>, xtmp, ytmp, pars2, pars2d0, pars2d, pars2dd<code class="label">&</code></a>
<a name="lgobfun_dv_dvi100"></a><a href="obfun_dv.html#lgobfun_dvi99" target="origFile"><code class="label">&                   </code>, restmp, restmpd0, restmpd, restmpdd, nbdirs, <code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi99" target="origFile"><code class="label">&                   </code>nbdirs0)</a>
<a name="lgobfun_dv_dvi101"></a>  <a href="obfun_dv.html#lgobfun_dvi100" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
    <a href="obfun_dv.html#lgobfun_dvi100" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#lgobfun_dvi101" target="origFile">lldd(nd0, nd) = lldd(nd0, nd) - restmpdd(nd0, nd, <code class="constant">1</code>)*<code class="funcname">EXP</code>(restmp(<code class="constant">1</code>)<code class="label">&</code></a>
<a href="obfun_dv.html#lgobfun_dvi101" target="origFile"><code class="label">&        </code>) - restmpd(nd, <code class="constant">1</code>)*restmpd0(nd0, <code class="constant">1</code>)*<code class="funcname">EXP</code>(restmp(<code class="constant">1</code>))</a>
    <a href="obfun_dv.html#lgobfun_dvi100" target="origFile"><code class="keyword">END DO</code></a>
<a name="lgobfun_dv_dvi102"></a>    <a href="obfun_dv.html#lgobfun_dvi101" target="origFile">lld(nd) = lld(nd) - restmpd(nd, <code class="constant">1</code>)*<code class="funcname">EXP</code>(restmp(<code class="constant">1</code>))</a>
  <a href="obfun_dv.html#lgobfun_dvi100" target="origFile"><code class="keyword">END DO</code></a>
<a href="obfun_dv.html#lgobfun_dvi102" target="origFile"><code class="comment">! add penalty term to objective</code></a>
  <a href="obfun_dv.html#lgobfun_dvi102" target="origFile">ll = ll - <code class="funcname">EXP</code>(restmp(<code class="constant">1</code>))</a>
<a name="loggausspdf_dv_dv"></a><a href="obfun_dv.html#lgobfun_dv" target="origFile"><code class="keyword">END </code><code class="keywork">SUBROUTINE </code><code class="funcname">LGOBFUN_DV_DV</code></a>

<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!  Differentiation of loggausspdf_dv in forward (tangent) mode: (multi-directional mode)</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!   variations  of output variables: resd res</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!   with respect to input variables: pars parsd</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!  Differentiation of loggausspdf in forward (tangent) mode: (multi-directional mode)</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!   variations  of output variables: res</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!   with respect to input variables: pars</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!----------------------------------------------------------------------</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! This file defines the objective function for local gaussian correlation</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!----------------------------------------------------------------------</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! Throughout, we use the convetion for parameters of a bivariate gaussian</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! pars(1) = mu_x</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! pars(2) = mu_y</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! pars(3) = sigma_x</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! pars(4) = sigma_y</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! pars(5) = rho</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!-------------------------------------------------------------------------</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! log-density of a bivariate Gaussian, vectorized in the data</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">! with parameters fixed</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">LOGGAUSSPDF_DV_DV</code>(<code class="vardecl">n</code>, <code class="vardecl">x</code>, <code class="vardecl">y</code>, <code class="vardecl">pars</code>, <code class="vardecl">parsd0</code>, <code class="vardecl">parsd</code>, <code class="vardecl">parsdd</code>, <code class="vardecl">res</code>, <code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="label">&  </code><code class="vardecl">resd0</code>, <code class="vardecl">resd</code>, <code class="vardecl">resdd</code>, <code class="vardecl">nbdirs</code>, <code class="vardecl">nbdirs0</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">USE </code><code class="funcname">DIFFSIZES</code></a>
<a name="loggausspdf_dv_dvi0"></a><a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="comment">!  Hint: nbdirsmax should be the maximum number of differentiation directions</code></a>
<a name="loggausspdf_dv_dvi1"></a>  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="loggausspdf_dv_dvi2"></a>  <a href="obfun_dv.html#loggausspdf_dvi0" target="origFile"><code class="typename">REAL*8, PARAMETER </code>:: <code class="vardecl">twopi</code>=<code class="constant">6.283185307179586e+00_8</code></a>
<a name="loggausspdf_dv_dvi3"></a>  <a href="obfun_dv.html#loggausspdf_dvi1" target="origFile"><code class="typename">INTEGER, INTENT(IN) </code>:: <code class="vardecl">n</code></a>
<a name="loggausspdf_dv_dvi4"></a>  <a href="obfun_dv.html#loggausspdf_dvi2" target="origFile"><code class="typename">REAL*8, DIMENSION(n), INTENT(IN) </code>:: <code class="vardecl">x</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi3" target="origFile"><code class="typename">REAL*8, DIMENSION(n), INTENT(IN) </code>:: <code class="vardecl">y</code></a>
<a name="loggausspdf_dv_dvi5"></a>  <a href="obfun_dv.html#loggausspdf_dvi4" target="origFile"><code class="typename">REAL*8, DIMENSION(5), INTENT(IN) </code>:: <code class="vardecl">pars</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5), INTENT(IN) </code>:: <code class="vardecl">parsd0</code></a>
<a name="loggausspdf_dv_dvi6"></a>  <a href="obfun_dv.html#loggausspdf_dvi5" target="origFile"><code class="typename">REAL*8, DIMENSION(5, 5), INTENT(IN) </code>:: <code class="vardecl">parsd</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, 5), INTENT(IN) </code>:: <code class="vardecl">parsdd</code></a>
<a name="loggausspdf_dv_dvi7"></a>  <a href="obfun_dv.html#loggausspdf_dvi6" target="origFile"><code class="typename">REAL*8, DIMENSION(n), INTENT(OUT) </code>:: <code class="vardecl">res</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, n), INTENT(OUT) </code>:: <code class="vardecl">resd0</code></a>
<a name="loggausspdf_dv_dvi8"></a>  <a href="obfun_dv.html#loggausspdf_dvi7" target="origFile"><code class="typename">REAL*8, DIMENSION(5, n), INTENT(OUT) </code>:: <code class="vardecl">resd</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, n), INTENT(OUT) </code>:: <code class="vardecl">resdd</code></a>
<a name="loggausspdf_dv_dvi9"></a>  <a href="obfun_dv.html#loggausspdf_dvi8" target="origFile"><code class="typename">REAL*8, DIMENSION(n) </code>:: <code class="vardecl">cen1</code>, <code class="vardecl">cen2</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, n) </code>:: <code class="vardecl">cen1d0</code>, <code class="vardecl">cen2d0</code></a>
<a name="loggausspdf_dv_dvi10"></a>  <a href="obfun_dv.html#loggausspdf_dvi9" target="origFile"><code class="typename">REAL*8, DIMENSION(5, n) </code>:: <code class="vardecl">cen1d</code>, <code class="vardecl">cen2d</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8, DIMENSION(nbdirsmax, 5, n) </code>:: <code class="vardecl">cen1dd</code>, <code class="vardecl">cen2dd</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi10" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">t1</code>, <code class="vardecl">f1</code>, <code class="vardecl">f2</code>, <code class="vardecl">f12</code></a>
<a name="loggausspdf_dv_dvi11"></a>  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">t1d0</code>(<code class="vardecl">nbdirsmax</code>), <code class="vardecl">f1d0</code>(<code class="vardecl">nbdirsmax</code>), <code class="vardecl">f2d0</code>(<code class="vardecl">nbdirsmax</code>), <code class="vardecl">f12d0</code>(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="label">&  </code><code class="vardecl">nbdirsmax</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dvi11" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">t1d</code>(<code class="constant">5</code>), <code class="vardecl">f1d</code>(<code class="constant">5</code>), <code class="vardecl">f2d</code>(<code class="constant">5</code>), <code class="vardecl">f12d</code>(<code class="constant">5</code>)</a>
<a name="loggausspdf_dv_dvi12"></a>  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">t1dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>), <code class="vardecl">f1dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>), <code class="vardecl">f2dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>), <code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="label">&  </code><code class="vardecl">f12dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>)</a>
<a name="loggausspdf_dv_dvi13"></a>  <a href="obfun_dv.html#loggausspdf_dvi12" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1d0</code>(<code class="vardecl">nbdirsmax</code>)</a>
<a name="loggausspdf_dv_dvi14"></a>  <a href="obfun_dv.html#loggausspdf_dvi13" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1d</code>(<code class="constant">5</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg1dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>)</a>
<a name="loggausspdf_dv_dvi15"></a>  <a href="obfun_dv.html#loggausspdf_dvi14" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1d0</code>(<code class="vardecl">nbdirsmax</code>)</a>
<a name="loggausspdf_dv_dvi16"></a>  <a href="obfun_dv.html#loggausspdf_dvi15" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1d</code>(<code class="constant">5</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result1dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>)</a>
<a name="loggausspdf_dv_dvi17"></a>  <a href="obfun_dv.html#loggausspdf_dvi16" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg2</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg2d0</code>(<code class="vardecl">nbdirsmax</code>)</a>
<a name="loggausspdf_dv_dvi18"></a>  <a href="obfun_dv.html#loggausspdf_dvi17" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg2d</code>(<code class="constant">5</code>)</a>
<a name="loggausspdf_dv_dvi19"></a>  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">arg2dd</code>(<code class="vardecl">nbdirsmax</code>, <code class="constant">5</code>)</a>
<a name="loggausspdf_dv_dvi20"></a>  <a href="obfun_dv.html#loggausspdf_dvi18" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nd</code></a>
<a name="loggausspdf_dv_dvi21"></a>  <a href="obfun_dv.html#loggausspdf_dvi19" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbdirs</code></a>
<a name="loggausspdf_dv_dvi22"></a>  <a href="obfun_dv.html#loggausspdf_dvi20" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">LOG</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi21" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi22" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result10</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">REAL*8 </code>:: <code class="vardecl">result10d</code>(<code class="vardecl">nbdirsmax</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nd0</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbdirs0</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi23" target="origFile">t1 = -(<code class="constant">0.5_8</code>/(<code class="constant">1.0_8</code>-pars(<code class="constant">5</code>)**<code class="constant">2</code>))</a>
  <a href="obfun_dv.html#loggausspdf_dvi29" target="origFile">arg1 = <code class="constant">1.0_8 </code>- pars(<code class="constant">5</code>)**<code class="constant">2</code></a>
<a name="loggausspdf_dv_dvi23"></a>  <a href="obfun_dv.html#loggausspdf_dvi30" target="origFile">result1 = <code class="funcname">SQRT</code>(arg1)</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
<a name="loggausspdf_dv_dvi24"></a>    <a href="obfun_dv.html#loggausspdf_dvi23" target="origFile">t1d0(nd0) = (-(<code class="constant">0.5_8</code>*<code class="constant">2</code>*pars(<code class="constant">5</code>)*parsd0(nd0, <code class="constant">5</code>)))/(<code class="constant">1.0_8</code>-pars(<code class="constant">5</code>)**<code class="constant">2</code>)**<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi23" target="origFile"><code class="label">&      </code><code class="constant">2</code></a>
<a name="loggausspdf_dv_dvi25"></a>    <a href="obfun_dv.html#loggausspdf_dvi24" target="origFile">f1d0(nd0) = (t1d0(nd0)*pars(<code class="constant">3</code>)**<code class="constant">2</code>-t1*<code class="constant">2</code>*pars(<code class="constant">3</code>)*parsd0(nd0, <code class="constant">3</code>))/(pars<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi24" target="origFile"><code class="label">&      </code>(<code class="constant">3</code>)**<code class="constant">2</code>)**<code class="constant">2</code></a>
<a name="loggausspdf_dv_dvi26"></a>    <a href="obfun_dv.html#loggausspdf_dvi25" target="origFile">f2d0(nd0) = (t1d0(nd0)*pars(<code class="constant">4</code>)**<code class="constant">2</code>-t1*<code class="constant">2</code>*pars(<code class="constant">4</code>)*parsd0(nd0, <code class="constant">4</code>))/(pars<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi25" target="origFile"><code class="label">&      </code>(<code class="constant">4</code>)**<code class="constant">2</code>)**<code class="constant">2</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi26" target="origFile">f12d0(nd0) = -((<code class="constant">2.0</code>*(parsd0(nd0, <code class="constant">5</code>)*t1+pars(<code class="constant">5</code>)*t1d0(nd0))*pars(<code class="constant">3</code>)*<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi27"></a><a href="obfun_dv.html#loggausspdf_dvi26" target="origFile"><code class="label">&      </code>pars(<code class="constant">4</code>)-<code class="constant">2.0</code>*pars(<code class="constant">5</code>)*t1*(parsd0(nd0, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+pars(<code class="constant">3</code>)*parsd0(nd0<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi28"></a><a href="obfun_dv.html#loggausspdf_dvi26" target="origFile"><code class="label">&      </code>, <code class="constant">4</code>)))/(pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>))**<code class="constant">2</code>)</a>
<a name="loggausspdf_dv_dvi29"></a>    <a href="obfun_dv.html#loggausspdf_dvi27" target="origFile">cen1d0(nd0, :) = -parsd0(nd0, <code class="constant">1</code>)</a>
<a name="loggausspdf_dv_dvi30"></a>    <a href="obfun_dv.html#loggausspdf_dvi28" target="origFile">cen2d0(nd0, :) = -parsd0(nd0, <code class="constant">2</code>)</a>
    <a href="obfun_dv.html#loggausspdf_dvi29" target="origFile">arg1d0(nd0) = -(<code class="constant">2</code>*pars(<code class="constant">5</code>)*parsd0(nd0, <code class="constant">5</code>))</a>
    <a href="obfun_dv.html#loggausspdf_dvi30" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi30" target="origFile">result1d0(nd0) = <code class="constant">0.0_8</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi30" target="origFile"><code class="keyword">ELSE</code></a>
<a name="loggausspdf_dv_dvi31"></a>      <a href="obfun_dv.html#loggausspdf_dvi30" target="origFile">result1d0(nd0) = arg1d0(nd0)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
    <a href="obfun_dv.html#loggausspdf_dvi30" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi31" target="origFile">arg2d0(nd0) = twopi*((parsd0(nd0, <code class="constant">3</code>)*result1+pars(<code class="constant">3</code>)*result1d0(nd0))<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi31" target="origFile"><code class="label">&      </code>*pars(<code class="constant">4</code>)+pars(<code class="constant">3</code>)*result1*parsd0(nd0, <code class="constant">4</code>))</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi24" target="origFile">f1 = t1/pars(<code class="constant">3</code>)**<code class="constant">2</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi25" target="origFile">f2 = t1/pars(<code class="constant">4</code>)**<code class="constant">2</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi26" target="origFile">f12 = -(<code class="constant">2.0</code>*pars(<code class="constant">5</code>)*t1/(pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)))</a>
  <a href="obfun_dv.html#loggausspdf_dvi27" target="origFile">cen1 = x - pars(<code class="constant">1</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dvi28" target="origFile">cen2 = y - pars(<code class="constant">2</code>)</a>
  <a href="obfun_dv.html#loggausspdf_dvi31" target="origFile">arg2 = twopi*pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)*result1</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">resdd(nd0, :, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">arg1dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">f12dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">cen2dd(nd0, :, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">f1dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">arg2dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">f2dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">result1dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">t1dd(nd0, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
<a name="loggausspdf_dv_dvi32"></a>    <a href="obfun_dv.html#loggausspdf_dv" target="origFile">cen1dd(nd0, :, :) = <code class="constant">0.0_8</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi32" target="origFile"><code class="keyword">DO </code>nd=<code class="constant">1</code>,nbdirs</a>
<a name="loggausspdf_dv_dvi33"></a>    <a href="obfun_dv.html#loggausspdf_dvi33" target="origFile">t1d(nd) = (-(<code class="constant">0.5_8</code>*<code class="constant">2</code>*pars(<code class="constant">5</code>)*parsd(nd, <code class="constant">5</code>)))/(<code class="constant">1.0_8</code>-pars(<code class="constant">5</code>)**<code class="constant">2</code>)**<code class="constant">2</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi32" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#loggausspdf_dvi33" target="origFile">t1dd(nd0, nd) = (-(<code class="constant">0.5_8</code>*<code class="constant">2</code>*(parsd0(nd0, <code class="constant">5</code>)*parsd(nd, <code class="constant">5</code>)+pars(<code class="constant">5</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi33" target="origFile"><code class="label">&        </code>parsdd(nd0, nd, <code class="constant">5</code>))*(<code class="constant">1.0_8</code>-pars(<code class="constant">5</code>)**<code class="constant">2</code>)**<code class="constant">2</code>)-<code class="constant">0.5_8</code>*<code class="constant">2</code>**<code class="constant">3</code>*pars(<code class="constant">5</code>)**<code class="constant">2</code><code class="label">&</code></a>
<a name="loggausspdf_dv_dvi34"></a><a href="obfun_dv.html#loggausspdf_dvi33" target="origFile"><code class="label">&        </code>*parsd(nd, <code class="constant">5</code>)*(<code class="constant">1.0_8</code>-pars(<code class="constant">5</code>)**<code class="constant">2</code>)*parsd0(nd0, <code class="constant">5</code>))/((<code class="constant">1.0_8</code>-pars(<code class="constant">5</code>)<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi33" target="origFile"><code class="label">&        </code>**<code class="constant">2</code>)**<code class="constant">2</code>)**<code class="constant">2</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi34" target="origFile">f1dd(nd0, nd) = ((t1dd(nd0, nd)*pars(<code class="constant">3</code>)**<code class="constant">2</code>+t1d(nd)*<code class="constant">2</code>*pars(<code class="constant">3</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi34" target="origFile"><code class="label">&        </code>parsd0(nd0, <code class="constant">3</code>)-<code class="constant">2</code>*((t1d0(nd0)*pars(<code class="constant">3</code>)+t1*parsd0(nd0, <code class="constant">3</code>))*parsd(nd<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi34" target="origFile"><code class="label">&        </code>, <code class="constant">3</code>))-<code class="constant">2</code>*(t1*pars(<code class="constant">3</code>)*parsdd(nd0, nd, <code class="constant">3</code>)))*pars(<code class="constant">3</code>)**<code class="constant">4</code>-(t1d(nd)*<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi35"></a><a href="obfun_dv.html#loggausspdf_dvi34" target="origFile"><code class="label">&        </code>pars(<code class="constant">3</code>)**<code class="constant">2</code>-t1*<code class="constant">2</code>*pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">3</code>))*<code class="constant">2</code>**<code class="constant">2</code>*pars(<code class="constant">3</code>)**<code class="constant">3</code>*parsd0(nd0<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi34" target="origFile"><code class="label">&        </code>, <code class="constant">3</code>))/((pars(<code class="constant">3</code>)**<code class="constant">2</code>)**<code class="constant">2</code>)**<code class="constant">2</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi35" target="origFile">f2dd(nd0, nd) = ((t1dd(nd0, nd)*pars(<code class="constant">4</code>)**<code class="constant">2</code>+t1d(nd)*<code class="constant">2</code>*pars(<code class="constant">4</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi35" target="origFile"><code class="label">&        </code>parsd0(nd0, <code class="constant">4</code>)-<code class="constant">2</code>*((t1d0(nd0)*pars(<code class="constant">4</code>)+t1*parsd0(nd0, <code class="constant">4</code>))*parsd(nd<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi35" target="origFile"><code class="label">&        </code>, <code class="constant">4</code>))-<code class="constant">2</code>*(t1*pars(<code class="constant">4</code>)*parsdd(nd0, nd, <code class="constant">4</code>)))*pars(<code class="constant">4</code>)**<code class="constant">4</code>-(t1d(nd)*<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi36"></a><a href="obfun_dv.html#loggausspdf_dvi35" target="origFile"><code class="label">&        </code>pars(<code class="constant">4</code>)**<code class="constant">2</code>-t1*<code class="constant">2</code>*pars(<code class="constant">4</code>)*parsd(nd, <code class="constant">4</code>))*<code class="constant">2</code>**<code class="constant">2</code>*pars(<code class="constant">4</code>)**<code class="constant">3</code>*parsd0(nd0<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi35" target="origFile"><code class="label">&        </code>, <code class="constant">4</code>))/((pars(<code class="constant">4</code>)**<code class="constant">2</code>)**<code class="constant">2</code>)**<code class="constant">2</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi36" target="origFile">f12dd(nd0, nd) = -(((<code class="constant">2.0</code>*((parsdd(nd0, nd, <code class="constant">5</code>)*t1+parsd(nd, <code class="constant">5</code>)*t1d0<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>(nd0)+parsd0(nd0, <code class="constant">5</code>)*t1d(nd)+pars(<code class="constant">5</code>)*t1dd(nd0, nd))*pars(<code class="constant">3</code>)*pars<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>(<code class="constant">4</code>)+(parsd(nd, <code class="constant">5</code>)*t1+pars(<code class="constant">5</code>)*t1d(nd))*(parsd0(nd0, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>pars(<code class="constant">3</code>)*parsd0(nd0, <code class="constant">4</code>)))-<code class="constant">2.0</code>*((parsd0(nd0, <code class="constant">5</code>)*t1+pars(<code class="constant">5</code>)*t1d0(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>nd0))*(parsd(nd, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>))+pars(<code class="constant">5</code>)*t1*(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>parsdd(nd0, nd, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+parsd(nd, <code class="constant">3</code>)*parsd0(nd0, <code class="constant">4</code>)+parsd0(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>nd0, <code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>)+pars(<code class="constant">3</code>)*parsdd(nd0, nd, <code class="constant">4</code>))))*pars(<code class="constant">3</code>)**<code class="constant">2</code>*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>pars(<code class="constant">4</code>)**<code class="constant">2</code>-(<code class="constant">2.0</code>*(parsd(nd, <code class="constant">5</code>)*t1+pars(<code class="constant">5</code>)*t1d(nd))*pars(<code class="constant">3</code>)*pars(<code class="constant">4</code><code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>)-<code class="constant">2.0</code>*pars(<code class="constant">5</code>)*t1*(parsd(nd, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>)))*<code class="constant">2</code>*<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi37"></a><a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)*(parsd0(nd0, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+pars(<code class="constant">3</code>)*parsd0(nd0, <code class="constant">4</code>)))<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi38"></a><a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&        </code>/((pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>))**<code class="constant">2</code>)**<code class="constant">2</code>)</a>
<a name="loggausspdf_dv_dvi39"></a>      <a href="obfun_dv.html#loggausspdf_dvi37" target="origFile">cen1dd(nd0, nd, :) = -parsdd(nd0, nd, <code class="constant">1</code>)</a>
      <a href="obfun_dv.html#loggausspdf_dvi38" target="origFile">cen2dd(nd0, nd, :) = -parsdd(nd0, nd, <code class="constant">2</code>)</a>
      <a href="obfun_dv.html#loggausspdf_dvi39" target="origFile">arg1dd(nd0, nd) = -(<code class="constant">2</code>*(parsd0(nd0, <code class="constant">5</code>)*parsd(nd, <code class="constant">5</code>)+pars(<code class="constant">5</code>)*parsdd(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi39" target="origFile"><code class="label">&        </code>nd0, nd, <code class="constant">5</code>)))</a>
    <a href="obfun_dv.html#loggausspdf_dvi32" target="origFile"><code class="keyword">END DO</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi34" target="origFile">f1d(nd) = (t1d(nd)*pars(<code class="constant">3</code>)**<code class="constant">2</code>-t1*<code class="constant">2</code>*pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">3</code>))/(pars(<code class="constant">3</code>)**<code class="constant">2</code><code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi34" target="origFile"><code class="label">&      </code>)**<code class="constant">2</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi35" target="origFile">f2d(nd) = (t1d(nd)*pars(<code class="constant">4</code>)**<code class="constant">2</code>-t1*<code class="constant">2</code>*pars(<code class="constant">4</code>)*parsd(nd, <code class="constant">4</code>))/(pars(<code class="constant">4</code>)**<code class="constant">2</code><code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi35" target="origFile"><code class="label">&      </code>)**<code class="constant">2</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi36" target="origFile">f12d(nd) = -((<code class="constant">2.0</code>*(parsd(nd, <code class="constant">5</code>)*t1+pars(<code class="constant">5</code>)*t1d(nd))*pars(<code class="constant">3</code>)*pars(<code class="constant">4</code>)-<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&      </code><code class="constant">2.0</code>*pars(<code class="constant">5</code>)*t1*(parsd(nd, <code class="constant">3</code>)*pars(<code class="constant">4</code>)+pars(<code class="constant">3</code>)*parsd(nd, <code class="constant">4</code>)))/(pars(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi36" target="origFile"><code class="label">&      </code><code class="constant">3</code>)*pars(<code class="constant">4</code>))**<code class="constant">2</code>)</a>
    <a href="obfun_dv.html#loggausspdf_dvi37" target="origFile">cen1d(nd, :) = -parsd(nd, <code class="constant">1</code>)</a>
<a name="p2"></a><a name="loggausspdf_dv_dvi40"></a>    <a href="obfun_dv.html#loggausspdf_dvi38" target="origFile">cen2d(nd, :) = -parsd(nd, <code class="constant">2</code>)</a>
    <a href="obfun_dv.html#loggausspdf_dvi39" target="origFile">arg1d(nd) = -(<code class="constant">2</code>*pars(<code class="constant">5</code>)*parsd(nd, <code class="constant">5</code>))</a>
<a name="loggausspdf_dv_dvi41"></a>    <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p2" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="obfun_dv.html#loggausspdf_dvi40" target="origFile">arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#loggausspdf_dvi41" target="origFile">result1dd(nd0, nd) = <code class="constant">0.0_8</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi41" target="origFile">result1d(nd) = <code class="constant">0.0</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">ELSE</code></a>
<a name="loggausspdf_dv_dvi42"></a>      <a href="obfun_dv.html#loggausspdf_dvi42" target="origFile">result10 = <code class="funcname">SQRT</code>(arg1)</a>
      <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
        <a href="obfun_dv.html#loggausspdf_dvi42" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="obfun_dv.html#loggausspdf_dvi42" target="origFile">result10d(nd0) = <code class="constant">0.0_8</code></a>
        <a href="obfun_dv.html#loggausspdf_dvi42" target="origFile"><code class="keyword">ELSE</code></a>
<a name="loggausspdf_dv_dvi43"></a>          <a href="obfun_dv.html#loggausspdf_dvi42" target="origFile">result10d(nd0) = arg1d0(nd0)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
        <a href="obfun_dv.html#loggausspdf_dvi42" target="origFile"><code class="keyword">END IF</code></a>
        <a href="obfun_dv.html#loggausspdf_dvi43" target="origFile">result1dd(nd0, nd) = (arg1dd(nd0, nd)*<code class="constant">2.0</code>*result10-arg1d(nd)*<code class="constant">2.0</code><code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi43" target="origFile"><code class="label">&          </code>*result10d(nd0))/(<code class="constant">2.0</code>*result10)**<code class="constant">2</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">END DO</code></a>
      <a href="obfun_dv.html#loggausspdf_dvi43" target="origFile">result1d(nd) = arg1d(nd)/(<code class="constant">2.0</code>*result10)</a>
    <a href="obfun_dv.html#loggausspdf_dvi40" target="origFile"><code class="keyword">END IF</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi44" target="origFile">arg2d(nd) = twopi*((parsd(nd, <code class="constant">3</code>)*result1+pars(<code class="constant">3</code>)*result1d(nd))*pars(<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi44"></a><a href="obfun_dv.html#loggausspdf_dvi44" target="origFile"><code class="label">&      </code><code class="constant">4</code>)+pars(<code class="constant">3</code>)*result1*parsd(nd, <code class="constant">4</code>))</a>
    <a href="obfun_dv.html#loggausspdf_dvi32" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
      <a href="obfun_dv.html#loggausspdf_dvi44" target="origFile">arg2dd(nd0, nd) = twopi*((parsdd(nd0, nd, <code class="constant">3</code>)*result1+parsd(nd, <code class="constant">3</code>)*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi44" target="origFile"><code class="label">&        </code>result1d0(nd0)+parsd0(nd0, <code class="constant">3</code>)*result1d(nd)+pars(<code class="constant">3</code>)*result1dd(nd0<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi44" target="origFile"><code class="label">&        </code>, nd))*pars(<code class="constant">4</code>)+(parsd(nd, <code class="constant">3</code>)*result1+pars(<code class="constant">3</code>)*result1d(nd))*<code class="label">&</code></a>
<a name="loggausspdf_dv_dvi45"></a><a href="obfun_dv.html#loggausspdf_dvi44" target="origFile"><code class="label">&        </code>parsd0(nd0, <code class="constant">4</code>)+(parsd0(nd0, <code class="constant">3</code>)*result1+pars(<code class="constant">3</code>)*result1d0(nd0))*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi44" target="origFile"><code class="label">&        </code>parsd(nd, <code class="constant">4</code>)+pars(<code class="constant">3</code>)*result1*parsdd(nd0, nd, <code class="constant">4</code>))</a>
      <a href="obfun_dv.html#loggausspdf_dvi45" target="origFile">resdd(nd0, nd, :) = f1dd(nd0, nd)*cen1**<code class="constant">2 </code>+ f1d(nd)*<code class="constant">2</code>*cen1*cen1d0(<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>nd0, :) - (arg2dd(nd0, nd)*arg2-arg2d(nd)*arg2d0(nd0))/arg2**<code class="constant">2 </code>+<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code><code class="constant">2</code>*((f1d0(nd0)*cen1+f1*cen1d0(nd0, :))*cen1d(nd, :)) + <code class="constant">2</code>*(f1*cen1<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>*cen1dd(nd0, nd, :)) + f2dd(nd0, nd)*cen2**<code class="constant">2 </code>+ f2d(nd)*<code class="constant">2</code>*cen2*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>cen2d0(nd0, :) + <code class="constant">2</code>*((f2d0(nd0)*cen2+f2*cen2d0(nd0, :))*cen2d(nd<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>, :)) + <code class="constant">2</code>*(f2*cen2*cen2dd(nd0, nd, :)) + (f12dd(nd0, nd)*cen1+<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>f12d(nd)*cen1d0(nd0, :)+f12d0(nd0)*cen1d(nd, :)+f12*cen1dd(nd0, <code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>nd, :))*cen2 + (f12d(nd)*cen1+f12*cen1d(nd, :))*cen2d0(nd0, :) +<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>(f12d0(nd0)*cen1+f12*cen1d0(nd0, :))*cen2d(nd, :) + f12*cen1*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&        </code>cen2dd(nd0, nd, :)</a>
    <a href="obfun_dv.html#loggausspdf_dvi32" target="origFile"><code class="keyword">END DO</code></a>
    <a href="obfun_dv.html#loggausspdf_dvi45" target="origFile">resd(nd, :) = f1d(nd)*cen1**<code class="constant">2 </code>- arg2d(nd)/arg2 + f1*<code class="constant">2</code>*cen1*cen1d(nd<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&      </code>, :) + f2d(nd)*cen2**<code class="constant">2 </code>+ f2*<code class="constant">2</code>*cen2*cen2d(nd, :) + (f12d(nd)*cen1+<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi45" target="origFile"><code class="label">&      </code>f12*cen1d(nd, :))*cen2 + f12*cen1*cen2d(nd, :)</a>
<a name="loggausspdf_dv_dvi46"></a>  <a href="obfun_dv.html#loggausspdf_dvi32" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">DO </code>nd0=<code class="constant">1</code>,nbdirs0</a>
    <a href="obfun_dv.html#loggausspdf_dvi46" target="origFile">resd0(nd0, :) = f1d0(nd0)*cen1**<code class="constant">2 </code>- arg2d0(nd0)/arg2 + f1*<code class="constant">2</code>*cen1*<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi46" target="origFile"><code class="label">&      </code>cen1d0(nd0, :) + f2d0(nd0)*cen2**<code class="constant">2 </code>+ f2*<code class="constant">2</code>*cen2*cen2d0(nd0, :) + (<code class="label">&</code></a>
<a href="obfun_dv.html#loggausspdf_dvi46" target="origFile"><code class="label">&      </code>f12d0(nd0)*cen1+f12*cen1d0(nd0, :))*cen2 + f12*cen1*cen2d0(nd0, :)</a>
  <a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END DO</code></a>
  <a href="obfun_dv.html#loggausspdf_dvi46" target="origFile">res = -<code class="funcname">LOG</code>(arg2) + f1*cen1**<code class="constant">2 </code>+ f2*cen2**<code class="constant">2 </code>+ f12*cen1*cen2</a>
<a href="obfun_dv.html#loggausspdf_dv" target="origFile"><code class="keyword">END </code><code class="keywork">SUBROUTINE </code><code class="funcname">LOGGAUSSPDF_DV_DV</code></a>

</pre>
</body>
